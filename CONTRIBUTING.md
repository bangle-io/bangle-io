# Contributing

## Styles

### Generation of css vars

The css vars  are generated by running the following command and the file is generated in `app/app-root/public`:

```sh
# root of the project
pnpm run generate-all

# in ui-theme
pnpm run generate:css-vars
```

## Handy tools

- [syncpack](https://github.com/JamieMason/syncpack)
  - `npx syncpack format` - format package.json
  - `npx syncpack update` - interactively update all dependencies

### Auto generating packages

Use [plopjs](https://plopjs.com/documentation/) to generate new packages.

```sh
npx plop lib
```


# Worker / Naukar

> `naukar` and `worker` are used interchangeably to mean the same thing [worker thread](https://developer.mozilla.org/en-US/docs/Web/API/Worker).


## Worker architecture

All of the worker code is contained in the `packages/app-worker`, except for the `@bangle.io/setup-worker` which lives in `package/app-bundler` and is a helper function to setup the worker.

1. We use a proxies to do a bi directional communication.
1. The worker methods are available to all of window via `eternalVars.naukar.<method>`.
1. Some state of the window is kept in a one way sync (main -> worker) thread using `json-patch` and `immer`.
1. Worker code can access this by using the slice: `slice-window-state`.
1. To change a window state, the worker code can take advantage of `WindowActions`.
